<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Sistem Jadwal Kuliah</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fc;
        }

        .wrapper {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, #628ecb 0%, #395886 100%);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s;
        }

        .sidebar-brand {
            padding: 20px;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-menu {
            list-style: none;
            padding: 20px 0;
        }

        .sidebar-menu li a {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
        }

        .sidebar-menu li a:hover,
        .sidebar-menu li a.active {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left: 4px solid white;
        }

        .sidebar-menu li a i {
            width: 30px;
            font-size: 16px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
        }

        /* Topbar */
        .topbar {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .topbar h1 {
            color: #5a5c69;
            font-size: 28px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #8aaee0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Content Area */
        .content {
            padding: 30px;
        }

        /* Pages */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Statistics Cards */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stat-card.primary { border-color: #4e73df; }
        .stat-card.success { border-color: #1cc88a; }
        .stat-card.warning { border-color: #f6c23e; }
        .stat-card.info { border-color: #36b9cc; }

        .stat-info h3 {
            color: #858796;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .stat-info .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #5a5c69;
        }

        .stat-icon {
            font-size: 35px;
            color: #dddfeb;
        }

        /* Data Table */
        .data-table-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            background: #f8f9fc;
            border-bottom: 1px solid #e3e6f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h2 {
            color: #5a5c69;
            font-size: 18px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #395886;
            color: white;
        }

        .btn-primary:hover {
            background: #628ecb;
        }

        .btn-success {
            background: #1cc88a;
            color: white;
        }

        .btn-danger {
            background: #e74a3b;
            color: white;
        }

        .btn-secondary {
            background: #858796;
            color: white;
        }

        .btn-secondary:hover {
            background: #60616f;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead {
            background: #f8f9fc;
        }

        .data-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #5a5c69;
            font-size: 13px;
            border-bottom: 2px solid #e3e6f0;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #e3e6f0;
            color: #5a5c69;
            font-size: 14px;
        }

        .data-table tbody tr {
            transition: all 0.3s ease;
        }

        .data-table tbody tr:hover {
            background: #f8f9fc;
        }

        .data-table tbody tr.removing {
            background: #f8d7da;
            opacity: 0;
            transform: translateX(-100%);
            transition: all 0.5s ease;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-berlangsung {
            background: #d4edda;
            color: #155724;
        }

        .status-akan-datang {
            background: #fff3cd;
            color: #856404;
        }

        .status-selesai {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-dibatalkan {
            background: #f8d7da;
            color: #721c24;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: #1cc88a;
        }

        .toast.error {
            background: #e74a3b;
        }

        /* Form Container */
        .form-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 30px;
            max-width: 900px;
        }

        .form-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e3e6f0;
        }

        .form-header h2 {
            color: #4e73df;
            font-size: 24px;
            margin-bottom: 5px;
        }

        .form-header p {
            color: #858796;
            font-size: 14px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row.full {
            grid-template-columns: 1fr;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #5a5c69;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group label .required {
            color: #e74a3b;
        }

        .form-control {
            padding: 12px;
            border: 1px solid #d1d3e2;
            border-radius: 5px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #4e73df;
            box-shadow: 0 0 0 3px rgba(78, 115, 223, 0.1);
        }

        select.form-control {
            cursor: pointer;
            background-color: white;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e3e6f0;
        }

        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e3e6f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: #4e73df;
            font-size: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #858796;
        }

        .modal-body {
            padding: 20px;
        }

        /* Confirmation Modal */
        .confirmation-modal .modal-content {
            max-width: 400px;
        }

        .confirmation-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* Checkbox Group */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 5px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            margin: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                margin-left: -260px;
            }

            .main-content {
                margin-left: 0;
            }

            .stats-row {
                grid-template-columns: 1fr;
            }

            .table-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .data-table {
                font-size: 12px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 20px;
            }

            .checkbox-group {
                flex-direction: column;
                gap: 10px;
            }

            .toast {
                left: 20px;
                right: 20px;
                transform: translateY(-100px);
            }

            .toast.show {
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-brand">
                <i class="fas fa-graduation-cap"></i> Jadwal Kuliah
            </div>
            <ul class="sidebar-menu">
                <li>
                    <a onclick="showPage('dashboard')" class="active" id="menu-dashboard">
                        <i class="fas fa-home"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a onclick="showPage('dosen')" id="menu-dosen">
                        <i class="fas fa-chalkboard-teacher"></i> Data Dosen
                    </a>
                </li>
                <li>
                    <a onclick="showPage('ruangan')" id="menu-ruangan">
                        <i class="fas fa-door-open"></i> Data Ruangan
                    </a>
                </li>
                <li>
                    <a onclick="showPage('matkul')" id="menu-matkul">
                        <i class="fas fa-book"></i> Data Mata Kuliah
                    </a>
                </li>
                <li>
                    <a onclick="showPage('kelas')" id="menu-kelas">
                        <i class="fas fa-users"></i> Data Kelas
                    </a>
                </li>
                <li>
                    <a onclick="showPage('jadwal')" id="menu-jadwal">
                        <i class="fas fa-calendar-alt"></i> Input Jadwal
                    </a>
                </li>
                <li>
                    <a onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Topbar -->
            <div class="topbar">
                <h1 id="pageTitle">Dashboard</h1>
                <div class="user-info">
                    <span>Admin TU</span>
                    <div class="user-avatar">AT</div>
                </div>
            </div>

            <!-- Content -->
            <div class="content">
                <!-- Dashboard Page -->
                <div id="page-dashboard" class="page active">
                    <!-- Statistics Cards -->
                    <div class="stats-row">
                        <div class="stat-card primary">
                            <div class="stat-info">
                                <h3>Total Dosen</h3>
                                <div class="stat-value" id="total-dosen">45</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                        </div>

                        <div class="stat-card success">
                            <div class="stat-info">
                                <h3>Total Ruangan</h3>
                                <div class="stat-value" id="total-ruangan">28</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-door-open"></i>
                            </div>
                        </div>

                        <div class="stat-card warning">
                            <div class="stat-info">
                                <h3>Jadwal Hari Ini</h3>
                                <div class="stat-value" id="total-jadwal">12</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                        </div>

                        <div class="stat-card info">
                            <div class="stat-info">
                                <h3>Mata Kuliah</h3>
                                <div class="stat-value" id="total-matkul">67</div>
                            </div>
                            <div class="stat-icon">
                                <i class="fas fa-book"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Data Table -->
                    <div class="data-table-section">
                        <div class="table-header">
                            <h2>Jadwal Kuliah Hari Ini</h2>
                            <button onclick="showPage('jadwal')" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Tambah Jadwal
                            </button>
                        </div>
                        <table class="data-table" id="table-jadwal">
                            <thead>
                                <tr>
                                    <th>Jam</th>
                                    <th>Mata Kuliah</th>
                                    <th>Dosen</th>
                                    <th>Ruangan</th>
                                    <th>Kelas</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tbody-jadwal">
                                <!-- Data jadwal akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Form Input Jadwal Page -->
                <div id="page-jadwal" class="page">
                    <div class="form-container">
                        <div class="form-header">
                            <h2><i class="fas fa-calendar-plus"></i> Form Input Jadwal Kuliah</h2>
                            <p>Lengkapi semua field untuk menambahkan jadwal kuliah baru</p>
                        </div>

                        <div class="alert alert-success" id="alertSuccess">
                            Jadwal berhasil disimpan!
                        </div>

                        <div class="alert alert-danger" id="alertError">
                            Terjadi kesalahan! Silakan periksa kembali data Anda.
                        </div>

                        <form id="formJadwal">
                            <input type="hidden" id="jadwal_id" name="id">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="hari">
                                        Hari <span class="required">*</span>
                                    </label>
                                    <select class="form-control" id="hari" name="hari" required>
                                        <option value="">-- Pilih Hari --</option>
                                        <option value="Senin">Senin</option>
                                        <option value="Selasa">Selasa</option>
                                        <option value="Rabu">Rabu</option>
                                        <option value="Kamis">Kamis</option>
                                        <option value="Jumat">Jumat</option>
                                        <option value="Sabtu">Sabtu</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="tanggal">
                                        Tanggal <span class="required">*</span>
                                    </label>
                                    <input type="date" class="form-control" id="tanggal" name="tanggal" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="jam_mulai">
                                        Jam Mulai <span class="required">*</span>
                                    </label>
                                    <input type="time" class="form-control" id="jam_mulai" name="jam_mulai" required>
                                </div>

                                <div class="form-group">
                                    <label for="jam_selesai">
                                        Jam Selesai <span class="required">*</span>
                                    </label>
                                    <input type="time" class="form-control" id="jam_selesai" name="jam_selesai" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="dosen">
                                        Dosen <span class="required">*</span>
                                    </label>
                                    <select class="form-control" id="dosen" name="id_dosen" required>
                                        <option value="">-- Pilih Dosen --</option>
                                        <!-- Options akan diisi oleh JavaScript -->
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="matkul">
                                        Mata Kuliah <span class="required">*</span>
                                    </label>
                                    <select class="form-control" id="matkul" name="id_matkul" required>
                                        <option value="">-- Pilih Mata Kuliah --</option>
                                        <!-- Options akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="ruangan">
                                        Ruangan <span class="required">*</span>
                                    </label>
                                    <select class="form-control" id="ruangan" name="id_ruangan" required>
                                        <option value="">-- Pilih Ruangan --</option>
                                        <!-- Options akan diisi oleh JavaScript -->
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="kelas">
                                        Kelas <span class="required">*</span>
                                    </label>
                                    <select class="form-control" id="kelas" name="id_kelas" required>
                                        <option value="">-- Pilih Kelas --</option>
                                        <!-- Options akan diisi oleh JavaScript -->
                                    </select>
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="status">
                                        Status <span class="required">*</span>
                                    </label>
                                    <select class="form-control" id="status" name="status" required>
                                        <option value="">-- Pilih Status --</option>
                                        <option value="Akan Datang">Akan Datang</option>
                                        <option value="Sedang Berlangsung">Sedang Berlangsung</option>
                                        <option value="Selesai">Selesai</option>
                                        <option value="Dibatalkan">Dibatalkan</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="keterangan">
                                        Keterangan (Opsional)
                                    </label>
                                    <textarea class="form-control" id="keterangan" name="keterangan" rows="3" placeholder="Tambahkan catatan atau keterangan khusus"></textarea>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Simpan Jadwal
                                </button>
                                <button type="reset" class="btn btn-secondary" onclick="resetForm('jadwal')">
                                    <i class="fas fa-undo"></i> Reset Form
                                </button>
                                <button type="button" onclick="showPage('dashboard')" class="btn btn-secondary">
                                    <i class="fas fa-arrow-left"></i> Kembali
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Data Dosen Page -->
                <div id="page-dosen" class="page">
                    <div class="data-table-section">
                        <div class="table-header">
                            <h2>Data Dosen</h2>
                            <button class="btn btn-primary" onclick="openDosenModal('tambah')">
                                <i class="fas fa-plus"></i> Tambah Dosen
                            </button>
                        </div>
                        <table class="data-table" id="table-dosen">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>NIDN</th>
                                    <th>Nama Dosen</th>
                                    <th>Email Dosen</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tbody-dosen">
                                <!-- Data dosen akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Data Ruangan Page -->
                <div id="page-ruangan" class="page">
                    <div class="data-table-section">
                        <div class="table-header">
                            <h2>Data Ruangan</h2>
                            <button class="btn btn-primary" onclick="openRuanganModal('tambah')">
                                <i class="fas fa-plus"></i> Tambah Ruangan
                            </button>
                        </div>
                        <table class="data-table" id="table-ruangan">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Kode Ruangan</th>
                                    <th>Nama Ruangan</th>
                                    <th>Kapasitas</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tbody-ruangan">
                                <!-- Data ruangan akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Data Mata Kuliah Page -->
                <div id="page-matkul" class="page">
                    <div class="data-table-section">
                        <div class="table-header">
                            <h2>Data Mata Kuliah</h2>
                            <button class="btn btn-primary" onclick="openMatkulModal('tambah')">
                                <i class="fas fa-plus"></i> Tambah Mata Kuliah
                            </button>
                        </div>
                        <table class="data-table" id="table-matkul">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Kode MK</th>
                                    <th>Nama Mata Kuliah</th>
                                    <th>SKS</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tbody-matkul">
                                <!-- Data mata kuliah akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Data Kelas Page -->
                <div id="page-kelas" class="page">
                    <div class="data-table-section">
                        <div class="table-header">
                            <h2>Data Kelas</h2>
                            <button class="btn btn-primary" onclick="openKelasModal('tambah')">
                                <i class="fas fa-plus"></i> Tambah Kelas
                            </button>
                        </div>
                        <table class="data-table" id="table-kelas">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>ID Kelas</th>
                                    <th>Nama Kelas</th>
                                    <th>Program Studi</th>
                                    <th>Tahun Angkatan</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tbody-kelas">
                                <!-- Data kelas akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Form Dosen -->
    <div class="modal" id="modal-dosen">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-chalkboard-teacher"></i> Form Data Dosen</h3>
                <button class="modal-close" onclick="closeModal('dosen')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formDosen">
                    <input type="hidden" id="dosen_id" name="id">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nidn">NIDN <span class="required">*</span></label>
                            <input type="text" class="form-control" id="nidn" name="nidn" required>
                        </div>
                        <div class="form-group">
                            <label for="nama_dosen">Nama Dosen <span class="required">*</span></label>
                            <input type="text" class="form-control" id="nama_dosen" name="nama_dosen" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="gelar">Gelar <span class="required">*</span></label>
                            <input type="text" class="form-control" id="gelar" name="gelar" placeholder="S.Kom, M.Kom" required>
                        </div>
                        <div class="form-group">
                            <label for="bidang_keahlian">Bidang Keahlian <span class="required">*</span></label>
                            <input type="text" class="form-control" id="bidang_keahlian" name="bidang_keahlian" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email <span class="required">*</span></label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="telepon">No. Telepon <span class="required">*</span></label>
                            <input type="tel" class="form-control" id="telepon" name="telepon" required>
                        </div>
                    </div>
                    <div class="form-row full">
                        <div class="form-group">
                            <label for="alamat">Alamat</label>
                            <textarea class="form-control" id="alamat" name="alamat" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="status_dosen">Status <span class="required">*</span></label>
                            <select class="form-control" id="status_dosen" name="status_dosen" required>
                                <option value="Aktif">Aktif</option>
                                <option value="Cuti">Cuti</option>
                                <option value="Tidak Aktif">Tidak Aktif</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Simpan Data
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('dosen')">
                            <i class="fas fa-times"></i> Batal
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Form Ruangan -->
    <div class="modal" id="modal-ruangan">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-door-open"></i> Form Data Ruangan</h3>
                <button class="modal-close" onclick="closeModal('ruangan')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formRuangan">
                    <input type="hidden" id="ruangan_id" name="id">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="kode_ruangan">Kode Ruangan <span class="required">*</span></label>
                            <input type="text" class="form-control" id="kode_ruangan" name="kode_ruangan" required>
                        </div>
                        <div class="form-group">
                            <label for="nama_ruangan">Nama Ruangan <span class="required">*</span></label>
                            <input type="text" class="form-control" id="nama_ruangan" name="nama_ruangan" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="kapasitas">Kapasitas <span class="required">*</span></label>
                            <input type="number" class="form-control" id="kapasitas" name="kapasitas" min="1" required>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Simpan Data
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('ruangan')">
                            <i class="fas fa-times"></i> Batal
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Form Mata Kuliah -->
    <div class="modal" id="modal-matkul">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-book"></i> Form Data Mata Kuliah</h3>
                <button class="modal-close" onclick="closeModal('matkul')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formMatkul">
                    <input type="hidden" id="matkul_id" name="id">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="kode_mk">Kode Mata Kuliah <span class="required">*</span></label>
                            <input type="text" class="form-control" id="kode_mk" name="kode_mk" required>
                        </div>
                        <div class="form-group">
                            <label for="nama_matkul">Nama Mata Kuliah <span class="required">*</span></label>
                            <input type="text" class="form-control" id="nama_matkul" name="nama_matkul" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="sks">SKS <span class="required">*</span></label>
                            <select class="form-control" id="sks" name="sks" required>
                                <option value="1">1 SKS</option>
                                <option value="2">2 SKS</option>
                                <option value="3">3 SKS</option>
                                <option value="4">4 SKS</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Simpan Data
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('matkul')">
                            <i class="fas fa-times"></i> Batal
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Form Kelas -->
    <div class="modal" id="modal-kelas">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-users"></i> Form Data Kelas</h3>
                <button class="modal-close" onclick="closeModal('kelas')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="formKelas">
                    <input type="hidden" id="kelas_id" name="id">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_kelas">ID Kelas <span class="required">*</span></label>
                            <input type="number" class="form-control" id="id_kelas" name="id_kelas" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="nama_kelas">Nama Kelas <span class="required">*</span></label>
                            <input type="text" class="form-control" id="nama_kelas" name="nama_kelas" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_prodi">Program Studi <span class="required">*</span></label>
                            <select class="form-control" id="id_prodi" name="id_prodi" required>
                                <option value="">-- Pilih Program Studi --</option>
                                <!-- Options akan diisi oleh JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tahun_angkatan">Tahun Angkatan <span class="required">*</span></label>
                            <input type="number" class="form-control" id="tahun_angkatan" name="tahun_angkatan" min="2000" max="2030" required>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Simpan Data
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('kelas')">
                            <i class="fas fa-times"></i> Batal
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal confirmation-modal" id="modal-confirm">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Konfirmasi Hapus</h3>
                <button class="modal-close" onclick="closeModal('confirm')">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Apakah Anda yakin ingin menghapus data ini?</p>
                <div class="confirmation-actions">
                    <button class="btn btn-danger" onclick="proceedDelete()">
                        <i class="fas fa-trash"></i> Ya, Hapus
                    </button>
                    <button class="btn btn-secondary" onclick="closeModal('confirm')">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

  <script>
    const API_URL = 'http://localhost:3000/api';
    let dosenList = [];
    let ruanganList = [];
    let matkulList = [];
    let kelasList = [];
    let deleteContext = { type: null, id: null };

    // Navigasi antar halaman
    function showPage(key) {
        // Atur menu aktif
        document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
        const activeMenu = document.getElementById(`menu-${key}`);
        if (activeMenu) activeMenu.classList.add('active');

        // Atur judul
        const titles = {
            dashboard: 'Dashboard',
            dosen: 'Data Dosen',
            ruangan: 'Data Ruangan',
            matkul: 'Data Mata Kuliah',
            kelas: 'Data Kelas',
            jadwal: 'Input Jadwal'
        };
        const pageTitle = document.getElementById('pageTitle');
        if (pageTitle) pageTitle.textContent = titles[key] || 'Dashboard';

        // Tampilkan halaman yang dipilih
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        const page = document.getElementById(`page-${key}`);
        if (page) page.classList.add('active');

        // Muat data sesuai halaman
        if (key === 'dosen') loadDosen();
        if (key === 'ruangan') loadRuangan();
        if (key === 'matkul') loadMatkul();
        if (key === 'kelas') loadKelas();
        if (key === 'jadwal') loadDropdownsForJadwal();
    }

    function logout() {
        window.location.href = 'LoginPage.html';
    }

    // ======== DATA DOSEN (CRUD) =========

    function loadDosen() {
        const tbody = document.getElementById('tbody-dosen');
        if (!tbody) return;
        tbody.innerHTML = '<tr><td colspan="5">Memuat data...</td></tr>';

        fetch(`${API_URL}/dosen`)
            .then(res => res.json())
            .then(data => {
                dosenList = data || [];
                renderDosenTable();
            })
            .catch(err => {
                console.error(err);
                tbody.innerHTML = '<tr><td colspan="5">Gagal memuat data dosen.</td></tr>';
                showToast('Gagal memuat data dosen', 'error');
            });
    }

    // ======== DATA RUANGAN (CRUD) =========

    function loadRuangan() {
        const tbody = document.getElementById('tbody-ruangan');
        if (!tbody) return;
        tbody.innerHTML = '<tr><td colspan="5">Memuat data...</td></tr>';

        fetch(`${API_URL}/ruangan`)
            .then(res => res.json())
            .then(data => {
                ruanganList = data || [];
                renderRuanganTable();
            })
            .catch(err => {
                console.error(err);
                tbody.innerHTML = '<tr><td colspan="5">Gagal memuat data ruangan.</td></tr>';
                showToast('Gagal memuat data ruangan', 'error');
            });
    }

    function renderRuanganTable() {
        const tbody = document.getElementById('tbody-ruangan');
        tbody.innerHTML = '';

        if (!ruanganList.length) {
            tbody.innerHTML = '<tr><td colspan="5">Belum ada data ruangan.</td></tr>';
            return;
        }

        ruanganList.forEach((r, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${index + 1}</td>
                <td>${r.ID_RUANGAN}</td>
                <td>${r.NAMA_RUANGAN}</td>
                <td>${r.KAPASITAS}</td>
                <td class="action-buttons">
                    <button class="btn btn-sm btn-secondary" onclick="editRuangan('${r.ID_RUANGAN}')">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="confirmDeleteRuangan('${r.ID_RUANGAN}')">
                        <i class="fas fa-trash"></i> Hapus
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function openRuanganModal(mode, ruangan = null) {
        const modal = document.getElementById('modal-ruangan');
        if (!modal) return;

        const form = document.getElementById('formRuangan');
        form.reset();

        document.getElementById('ruangan_id').value = ruangan && ruangan.ID_RUANGAN ? ruangan.ID_RUANGAN : '';

        if (ruangan) {
            document.getElementById('kode_ruangan').value = ruangan.ID_RUANGAN || '';
            document.getElementById('nama_ruangan').value = ruangan.NAMA_RUANGAN || '';
            document.getElementById('kapasitas').value = ruangan.KAPASITAS || '';
        }

        modal.classList.add('active');
    }

    function editRuangan(id) {
        const ruangan = ruanganList.find(r => r.ID_RUANGAN === id);
        if (!ruangan) {
            showToast('Data ruangan tidak ditemukan', 'error');
            return;
        }
        openRuanganModal('edit', ruangan);
    }

    // ======== DATA MATA KULIAH (CRUD) =========

    function loadMatkul() {
        const tbody = document.getElementById('tbody-matkul');
        if (!tbody) return;
        tbody.innerHTML = '<tr><td colspan="5">Memuat data...</td></tr>';

        fetch(`${API_URL}/matkul`)
            .then(res => res.json())
            .then(data => {
                matkulList = data || [];
                renderMatkulTable();
            })
            .catch(err => {
                console.error(err);
                tbody.innerHTML = '<tr><td colspan="5">Gagal memuat data mata kuliah.</td></tr>';
                showToast('Gagal memuat data mata kuliah', 'error');
            });
    }

    function renderMatkulTable() {
        const tbody = document.getElementById('tbody-matkul');
        tbody.innerHTML = '';

        if (!matkulList.length) {
            tbody.innerHTML = '<tr><td colspan="5">Belum ada data mata kuliah.</td></tr>';
            return;
        }

        matkulList.forEach((m, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${index + 1}</td>
                <td>${m.KODE_MATKUL}</td>
                <td>${m.NAMA_MATKUL}</td>
                <td>${m.SKS}</td>
                <td class="action-buttons">
                    <button class="btn btn-sm btn-secondary" onclick="editMatkul('${m.KODE_MATKUL}')">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="confirmDeleteMatkul('${m.KODE_MATKUL}')">
                        <i class="fas fa-trash"></i> Hapus
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function openMatkulModal(mode, matkul = null) {
        const modal = document.getElementById('modal-matkul');
        if (!modal) return;

        const form = document.getElementById('formMatkul');
        form.reset();

        document.getElementById('matkul_id').value = matkul && matkul.KODE_MATKUL ? matkul.KODE_MATKUL : '';

        if (matkul) {
            document.getElementById('kode_mk').value = matkul.KODE_MATKUL || '';
            document.getElementById('nama_matkul').value = matkul.NAMA_MATKUL || '';
            document.getElementById('sks').value = matkul.SKS || '1';
        }

        modal.classList.add('active');
    }

    function editMatkul(kode) {
        const matkul = matkulList.find(m => m.KODE_MATKUL === kode);
        if (!matkul) {
            showToast('Data mata kuliah tidak ditemukan', 'error');
            return;
        }
        openMatkulModal('edit', matkul);
    }

    // ======== DATA KELAS (CRUD) =========

    function loadKelas() {
        const tbody = document.getElementById('tbody-kelas');
        if (!tbody) return;
        tbody.innerHTML = '<tr><td colspan="6">Memuat data...</td></tr>';

        fetch(`${API_URL}/kelas`)
            .then(res => res.json())
            .then(data => {
                kelasList = data || [];
                renderKelasTable();
            })
            .catch(err => {
                console.error(err);
                tbody.innerHTML = '<tr><td colspan="6">Gagal memuat data kelas.</td></tr>';
                showToast('Gagal memuat data kelas', 'error');
            });
    }

    function renderKelasTable() {
        const tbody = document.getElementById('tbody-kelas');
        tbody.innerHTML = '';

        if (!kelasList.length) {
            tbody.innerHTML = '<tr><td colspan="6">Belum ada data kelas.</td></tr>';
            return;
        }

        kelasList.forEach((k, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${index + 1}</td>
                <td>${k.ID_KELAS}</td>
                <td>${k.NAMA_KELAS}</td>
                <td>${k.NAMA_PRODI || '-'}</td>
                <td>${k.TAHUN_ANGKATAN || '-'}</td>
                <td class="action-buttons">
                    <button class="btn btn-sm btn-secondary" onclick="editKelas('${k.ID_KELAS}')">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="confirmDeleteKelas('${k.ID_KELAS}')">
                        <i class="fas fa-trash"></i> Hapus
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function openKelasModal(mode, kelas = null) {
        const modal = document.getElementById('modal-kelas');
        if (!modal) return;

        const form = document.getElementById('formKelas');
        form.reset();

        // Load program studi ke dropdown
        loadProgramStudi();

        if (kelas) {
            document.getElementById('kelas_id').value = kelas.ID_KELAS;
            document.getElementById('id_kelas').value = kelas.ID_KELAS;
            document.getElementById('nama_kelas').value = kelas.NAMA_KELAS || '';
            document.getElementById('id_prodi').value = kelas.ID_PRODI || '';
            document.getElementById('tahun_angkatan').value = kelas.TAHUN_ANGKATAN || '';
        } else {
            document.getElementById('kelas_id').value = '';
        }

        modal.classList.add('active');
    }

    function loadProgramStudi() {
        const selectProdi = document.getElementById('id_prodi');
        if (!selectProdi) return;

        fetch(`${API_URL}/prodi`)
            .then(res => res.json())
            .then(data => {
                selectProdi.innerHTML = '<option value="">-- Pilih Program Studi --</option>';
                data.forEach(prodi => {
                    const option = document.createElement('option');
                    option.value = prodi.ID_PRODI;
                    option.textContent = prodi.NAMA_PRODI;
                    selectProdi.appendChild(option);
                });
            })
            .catch(err => {
                console.error('Error loading program studi:', err);
            });
    }

    function editKelas(id) {
        const kelas = kelasList.find(k => k.ID_KELAS == id);
        if (!kelas) {
            showToast('Data kelas tidak ditemukan', 'error');
            return;
        }
        openKelasModal('edit', kelas);
    }

    function confirmDeleteKelas(id) {
        deleteContext = { type: 'kelas', id: id };
        const modal = document.getElementById('modal-confirm');
        const msg = document.getElementById('confirmMessage');
        if (msg) msg.textContent = `Apakah Anda yakin ingin menghapus kelas dengan ID ${id}?`;
        if (modal) modal.classList.add('active');
    }

    // ======== LOAD DROPDOWN UNTUK FORM JADWAL =========
    function loadDropdownsForJadwal() {
        // Load dan isi dropdown Dosen
        fetch(`${API_URL}/dosen`)
            .then(res => res.json())
            .then(data => {
                dosenList = data || [];
                const selectDosen = document.getElementById('dosen');
                if (selectDosen) {
                    selectDosen.innerHTML = '<option value="">-- Pilih Dosen --</option>';
                    dosenList.forEach(dosen => {
                        const option = document.createElement('option');
                        option.value = dosen.NIDN;
                        option.textContent = `${dosen.NIDN} - ${dosen.NAMA_DOSEN}`;
                        selectDosen.appendChild(option);
                    });
                }
            })
            .catch(err => {
                console.error('Error loading dosen:', err);
                showToast('Gagal memuat data dosen', 'error');
            });

        // Load dan isi dropdown Ruangan
        fetch(`${API_URL}/ruangan`)
            .then(res => res.json())
            .then(data => {
                ruanganList = data || [];
                const selectRuangan = document.getElementById('ruangan');
                if (selectRuangan) {
                    selectRuangan.innerHTML = '<option value="">-- Pilih Ruangan --</option>';
                    ruanganList.forEach(ruangan => {
                        const option = document.createElement('option');
                        option.value = ruangan.ID_RUANGAN;
                        option.textContent = `${ruangan.ID_RUANGAN} - ${ruangan.NAMA_RUANGAN} (Kapasitas: ${ruangan.KAPASITAS})`;
                        selectRuangan.appendChild(option);
                    });
                }
            })
            .catch(err => {
                console.error('Error loading ruangan:', err);
                showToast('Gagal memuat data ruangan', 'error');
            });

        // Load dan isi dropdown Mata Kuliah
        fetch(`${API_URL}/matkul`)
            .then(res => res.json())
            .then(data => {
                matkulList = data || [];
                const selectMatkul = document.getElementById('matkul');
                if (selectMatkul) {
                    selectMatkul.innerHTML = '<option value="">-- Pilih Mata Kuliah --</option>';
                    matkulList.forEach(matkul => {
                        const option = document.createElement('option');
                        option.value = matkul.KODE_MATKUL;
                        option.textContent = `${matkul.KODE_MATKUL} - ${matkul.NAMA_MATKUL} (${matkul.SKS} SKS)`;
                        selectMatkul.appendChild(option);
                    });
                }
            })
            .catch(err => {
                console.error('Error loading matkul:', err);
                showToast('Gagal memuat data mata kuliah', 'error');
            });

        // Load dan isi dropdown Kelas
        fetch(`${API_URL}/kelas`)
            .then(res => res.json())
            .then(data => {
                kelasList = data || [];
                const selectKelas = document.getElementById('kelas');
                if (selectKelas) {
                    selectKelas.innerHTML = '<option value="">-- Pilih Kelas --</option>';
                    kelasList.forEach(kelas => {
                        const option = document.createElement('option');
                        option.value = kelas.ID_KELAS;
                        option.textContent = `${kelas.ID_KELAS} - ${kelas.NAMA_KELAS} (Angkatan: ${kelas.TAHUN_ANGKATAN})`;
                        selectKelas.appendChild(option);
                    });
                }
            })
            .catch(err => {
                console.error('Error loading kelas:', err);
                showToast('Gagal memuat data kelas', 'error');
            });
    }

    function renderDosenTable() {
        const tbody = document.getElementById('tbody-dosen');
        tbody.innerHTML = '';

        if (!dosenList.length) {
            tbody.innerHTML = '<tr><td colspan="5">Belum ada data dosen.</td></tr>';
            return;
        }

        dosenList.forEach((d, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${index + 1}</td>
                <td>${d.NIDN}</td>
                <td>${d.NAMA_DOSEN}</td>
                <td>${d.EMAIL_DOSEN || '-'}</td>
                <td class="action-buttons">
                    <button class="btn btn-sm btn-secondary" onclick="editDosen('${d.NIDN}')">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="confirmDeleteDosen('${d.NIDN}')">
                        <i class="fas fa-trash"></i> Hapus
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function openDosenModal(mode, dosen = null) {
        const modal = document.getElementById('modal-dosen');
        if (!modal) return;

        const form = document.getElementById('formDosen');
        form.reset();

        // Simpan NIDN lama di hidden input untuk update
        document.getElementById('dosen_id').value = dosen && dosen.NIDN ? dosen.NIDN : '';

        if (dosen) {
            document.getElementById('nidn').value = dosen.NIDN || '';
            document.getElementById('nama_dosen').value = dosen.NAMA_DOSEN || '';
            document.getElementById('email').value = dosen.EMAIL_DOSEN || '';
        }

        modal.classList.add('active');
    }

    function editDosen(nidn) {
        const dosen = dosenList.find(d => d.NIDN === nidn);
        if (!dosen) {
            showToast('Data dosen tidak ditemukan', 'error');
            return;
        }
        openDosenModal('edit', dosen);
    }

    function closeModal(name) {
        const modal = document.getElementById(`modal-${name}`);
        if (modal) modal.classList.remove('active');
    }

    document.addEventListener('DOMContentLoaded', () => {
        // Submit form dosen
        const formDosen = document.getElementById('formDosen');
        formDosen.addEventListener('submit', function (e) {
            e.preventDefault();

            const nidn = document.getElementById('nidn').value.trim();
            const nama_dosen = document.getElementById('nama_dosen').value.trim();
            const email_dosen = document.getElementById('email').value.trim();
            const idLama = document.getElementById('dosen_id').value.trim();

            if (!nidn || !nama_dosen || !email_dosen) {
                showToast('NIDN, Nama Dosen, dan Email wajib diisi', 'error');
                return;
            }

            const payload = { nidn, nama_dosen, email_dosen };
            const isEdit = !!idLama;
            const url = isEdit ? `${API_URL}/dosen/${idLama}` : `${API_URL}/dosen`;
            const method = isEdit ? 'PUT' : 'POST';

            fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
                .then(res => res.json())
                .then(data => {
                    showToast(data.message || 'Data dosen berhasil disimpan', 'success');
                    closeModal('dosen');
                    loadDosen();
                })
                .catch(err => {
                    console.error(err);
                    showToast('Terjadi kesalahan saat menyimpan data dosen', 'error');
                });
        });

        // Submit form ruangan
        const formRuangan = document.getElementById('formRuangan');
        formRuangan.addEventListener('submit', function (e) {
            e.preventDefault();

            const id_ruangan = document.getElementById('kode_ruangan').value.trim();
            const nama_ruangan = document.getElementById('nama_ruangan').value.trim();
            const kapasitas = document.getElementById('kapasitas').value.trim();
            const idLama = document.getElementById('ruangan_id').value.trim();

            if (!id_ruangan || !nama_ruangan || !kapasitas) {
                showToast('Kode, Nama, dan Kapasitas Ruangan wajib diisi', 'error');
                return;
            }

            const payload = { id_ruangan, nama_ruangan, kapasitas };
            const isEdit = !!idLama;
            const url = isEdit ? `${API_URL}/ruangan/${idLama}` : `${API_URL}/ruangan`;
            const method = isEdit ? 'PUT' : 'POST';

            fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
                .then(res => res.json())
                .then(data => {
                    showToast(data.message || 'Data ruangan berhasil disimpan', 'success');
                    closeModal('ruangan');
                    loadRuangan();
                })
                .catch(err => {
                    console.error(err);
                    showToast('Terjadi kesalahan saat menyimpan data ruangan', 'error');
                });
        });

        // Submit form mata kuliah
        const formMatkul = document.getElementById('formMatkul');
        formMatkul.addEventListener('submit', function (e) {
            e.preventDefault();

            const kode_matkul = document.getElementById('kode_mk').value.trim();
            const nama_matkul = document.getElementById('nama_matkul').value.trim();
            const sks = document.getElementById('sks').value.trim();
            const idLama = document.getElementById('matkul_id').value.trim();

            if (!kode_matkul || !nama_matkul || !sks) {
                showToast('Kode, Nama Mata Kuliah, dan SKS wajib diisi', 'error');
                return;
            }

            const payload = { kode_matkul, nama_matkul, sks };
            const isEdit = !!idLama;
            const url = isEdit ? `${API_URL}/matkul/${idLama}` : `${API_URL}/matkul`;
            const method = isEdit ? 'PUT' : 'POST';

            fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
                .then(res => res.json())
                .then(data => {
                    showToast(data.message || 'Data mata kuliah berhasil disimpan', 'success');
                    closeModal('matkul');
                    loadMatkul();
                })
                .catch(err => {
                    console.error(err);
                    showToast('Terjadi kesalahan saat menyimpan data mata kuliah', 'error');
                });
        });

        // Submit form jadwal
        const formJadwal = document.getElementById('formJadwal');
        formJadwal.addEventListener('submit', function (e) {
            e.preventDefault();

            const hari = document.getElementById('hari').value.trim();
            const tanggal = document.getElementById('tanggal').value.trim();
            const jam_mulai = document.getElementById('jam_mulai').value.trim();
            const jam_selesai = document.getElementById('jam_selesai').value.trim();
            const dosen = document.getElementById('dosen').value.trim();
            const matkul = document.getElementById('matkul').value.trim();
            const ruangan = document.getElementById('ruangan').value.trim();
            const kelas = document.getElementById('kelas').value.trim();
            const status = document.getElementById('status').value.trim();
            const keterangan = document.getElementById('keterangan').value.trim();
            const idLama = document.getElementById('jadwal_id').value.trim();

            if (!hari || !tanggal || !jam_mulai || !jam_selesai || !dosen || !matkul || !ruangan || !kelas || !status) {
                showToast('Semua field wajib diisi kecuali keterangan', 'error');
                return;
            }

            const payload = {
                hari,
                tanggal,
                jam_mulai,
                jam_selesai,
                nidn: parseInt(dosen),
                kode_matkul: parseInt(matkul),
                id_ruangan: parseInt(ruangan),
                id_kelas: parseInt(kelas),
                keterangan: keterangan || null
            };

            const isEdit = !!idLama;
            const url = isEdit ? `${API_URL}/jadwal/${idLama}` : `${API_URL}/jadwal`;
            const method = isEdit ? 'PUT' : 'POST';

            fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
                .then(res => res.json())
                .then(data => {
                    showToast(data.message || 'Jadwal berhasil disimpan', 'success');
                    formJadwal.reset();
                    // Reset hidden field
                    document.getElementById('jadwal_id').value = '';
                })
                .catch(err => {
                    console.error('Error:', err);
                    showToast('Terjadi kesalahan saat menyimpan jadwal. Pastikan server berjalan di http://localhost:3000', 'error');
                });
        });

        // Submit form kelas
        const formKelas = document.getElementById('formKelas');
        formKelas.addEventListener('submit', function (e) {
            e.preventDefault();

            const id_kelas = document.getElementById('id_kelas').value.trim();
            const id_prodi = document.getElementById('id_prodi').value.trim();
            const nama_kelas = document.getElementById('nama_kelas').value.trim();
            const tahun_angkatan = document.getElementById('tahun_angkatan').value.trim();
            const idLama = document.getElementById('kelas_id').value.trim();

            if (!id_kelas || !id_prodi || !nama_kelas || !tahun_angkatan) {
                showToast('ID Kelas, Program Studi, Nama Kelas, dan Tahun Angkatan wajib diisi', 'error');
                return;
            }

            const payload = { 
                id_kelas: parseInt(id_kelas), 
                id_prodi: parseInt(id_prodi), 
                nama_kelas, 
                tahun_angkatan: parseInt(tahun_angkatan) 
            };
            const isEdit = !!idLama;
            const url = isEdit ? `${API_URL}/kelas/${idLama}` : `${API_URL}/kelas`;
            const method = isEdit ? 'PUT' : 'POST';

            fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            })
                .then(res => res.json())
                .then(data => {
                    showToast(data.message || 'Data kelas berhasil disimpan', 'success');
                    closeModal('kelas');
                    loadKelas();
                })
                .catch(err => {
                    console.error(err);
                    showToast('Terjadi kesalahan saat menyimpan data kelas', 'error');
                });
        });

        // Halaman awal
        showPage('dashboard');
    });

    function confirmDeleteDosen(nidn) {
        deleteContext = { type: 'dosen', id: nidn };
        const modal = document.getElementById('modal-confirm');
        const msg = document.getElementById('confirmMessage');
        if (msg) msg.textContent = `Apakah Anda yakin ingin menghapus dosen dengan NIDN ${nidn}?`;
        if (modal) modal.classList.add('active');
    }

    function confirmDeleteRuangan(id) {
        deleteContext = { type: 'ruangan', id };
        const modal = document.getElementById('modal-confirm');
        const msg = document.getElementById('confirmMessage');
        if (msg) msg.textContent = `Apakah Anda yakin ingin menghapus ruangan dengan kode ${id}?`;
        if (modal) modal.classList.add('active');
    }

    function confirmDeleteMatkul(kode) {
        deleteContext = { type: 'matkul', id: kode };
        const modal = document.getElementById('modal-confirm');
        const msg = document.getElementById('confirmMessage');
        if (msg) msg.textContent = `Apakah Anda yakin ingin menghapus mata kuliah dengan kode ${kode}?`;
        if (modal) modal.classList.add('active');
    }

    function proceedDelete() {
        if (!deleteContext.type || !deleteContext.id) {
            closeModal('confirm');
            return;
        }

        const { type, id } = deleteContext;
        fetch(`${API_URL}/${type}/${id}`, { method: 'DELETE' })
            .then(res => res.json())
            .then(data => {
                showToast(data.message || 'Data berhasil dihapus', 'success');
                if (type === 'dosen') loadDosen();
                if (type === 'ruangan') loadRuangan();
                if (type === 'matkul') loadMatkul();
                if (type === 'kelas') loadKelas();
            })
            .catch(err => {
                console.error(err);
                showToast('Gagal menghapus data', 'error');
            })
            .finally(() => {
                deleteContext = { type: null, id: null };
                closeModal('confirm');
            });
    }

    function showToast(message, type = 'success') {
        const toast = document.getElementById('toast');
        if (!toast) return;
        toast.textContent = message;
        toast.className = `toast show ${type}`;
        setTimeout(() => {
            toast.className = 'toast';
        }, 3000);
    }
  </script>
</body>
</html>
</html>